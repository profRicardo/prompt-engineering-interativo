<!DOCTYPE html>
<html lang="pt-PT">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Engenharia de Prompts para Imagens - Ferramenta Final PT v7</title> <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" integrity="sha512-9usAa10IRO0HhonpyAIVpjrylPvoDwiPUiKdWk5t3PyolY1cOd4DSE0Ga+ri4AuTroPR5aQvXU9xC6qOPnzFeg==" crossorigin="anonymous" referrerpolicy="no-referrer" />

    <style>
        /* --- Estilos Gerais (Mantidos e Refinados) --- */
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol"; line-height: 1.6; margin: 0; padding: 20px; background-color: #f8f9fa; color: #212529; padding-bottom: 60px; }
        #container { max-width: 850px; margin: 20px auto; padding: 25px; background-color: #ffffff; border-radius: 10px; box-shadow: 0 4px 12px rgba(0,0,0,0.08); border: 1px solid #dee2e6; padding-bottom: 40px; }
        h1, h2 { color: #0056b3; text-align: center; margin-bottom: 25px; padding-bottom: 15px; border-bottom: 1px solid #e9ecef; font-weight: 600; }
        h1 { font-size: 2.2em; }
        h2 { font-size: 1.6em; }
        hr { border: 0; height: 1px; background: #dee2e6; margin: 35px 0; }
        p { margin-bottom: 1.1em; color: #495057; }
        #imagem-ilustrativa { display: block; max-width: 70%; height: auto; margin: 15px auto 35px auto; border-radius: 8px; box-shadow: 0 4px 8px rgba(0,0,0,0.1); }

        /* --- Estilos específicos para CODE e PRE --- */
        code, pre code { font-family: "SFMono-Regular", Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace; background-color: #e9ecef; padding: 3px 6px; border-radius: 4px; font-size: 0.9em; color: #343a40; }
        pre { background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 12px; margin-top: 12px; white-space: pre-wrap; word-wrap: break-word; border-radius: 5px; }
        pre code { background-color: transparent; padding: 0; border-radius: 0; font-size: 1em; }
        .exemplo-fraco pre { border-left: 5px solid #dc3545; background: #fef4f4; }
        .exemplo-forte pre { border-left: 5px solid #28a745; background: #f4fef7; }
        #exemploReferenciaPlayground pre { background: #f4fef7; border-left: 5px solid #28a745; }
        #infoTecnica strong { color: #0056b3; font-weight: 600; }
        #infoTecnica p strong { color: #d9534f; font-weight: 600;}

        /* --- Secção Explorador --- */
        #explorer { margin-bottom: 30px; }
        #botoesTecnicas { display: flex; flex-wrap: wrap; gap: 12px; margin-bottom: 25px; justify-content: center; }
        .botao-tecnica { padding: 10px 18px; background-color: #f1f3f5; border: 1px solid #ced4da; border-radius: 6px; cursor: pointer; transition: all 0.2s ease-in-out; font-size: 0.95em; color: #495057; font-weight: 500; }
        .botao-tecnica:hover { background-color: #e9ecef; border-color: #adb5bd; transform: translateY(-1px); }
        .botao-tecnica.ativo { background-color: #0056b3; color: white; font-weight: 600; border-color: #003d80; box-shadow: 0 2px 4px rgba(0, 86, 179, 0.2); }
        #infoTecnica { background-color: #ffffff; border: 1px solid #e9ecef; padding: 20px; border-radius: 8px; min-height: 100px; opacity: 0; transform: translateY(10px); transition: opacity 0.4s ease, transform 0.4s ease; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        #infoTecnica.visivel { opacity: 1; transform: translateY(0); }
        #infoTecnica h3 { margin-top: 0; color: #0056b3; font-size: 1.3em; margin-bottom: 15px; font-weight: 600; }
        #infoTecnica h3 i { margin-right: 8px; }

        /* --- Estilos Playground e Builder --- */
        #playground { margin-top: 30px; margin-bottom: 30px; background-color: #e7f5ff; border: 1px solid #b3d7ff; padding: 25px; border-radius: 8px; }
        #playground h2 { color: #0056b3; text-align: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #cce0ff; font-size: 1.6em; }
        #playground h2 i { margin-right: 10px; }
        #instrucaoPlayground { background-color: #fff; border-left: 5px solid #17a2b8; padding: 12px 18px; margin-bottom: 25px; border-radius: 5px; color: #343a40; box-shadow: 0 1px 3px rgba(0,0,0,0.05); }
        #instrucaoPlayground strong { color: #0056b3; font-weight: 600; }

        #promptBuilderArea { margin-bottom: 25px; padding: 20px; background-color: #f8f9fa; border-radius: 6px; border: 1px solid #dee2e6; }
        #promptBuilderArea label { display: block; margin-bottom: 6px; font-weight: 600; color: #495057; font-size: 0.95em; }
        #promptBuilderArea select { width: 100%; padding: 10px 12px; margin-bottom: 18px; border: 1px solid #ced4da; border-radius: 5px; background-color: #fff; font-size: 1em; box-sizing: border-box; cursor: pointer; -webkit-appearance: none; appearance: none; background-image: url('data:image/svg+xml;charset=US-ASCII,%3Csvg%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%20width%3D%22292.4%22%20height%3D%22292.4%22%3E%3Cpath%20fill%3D%22%23007CB2%22%20d%3D%22M287%2069.4a17.6%2017.6%200%200%200-13-5.4H18.4c-5%200-9.3%201.8-12.9%205.4A17.6%2017.6%200%200%200%200%2082.2c0%205%201.8%209.3%205.4%2012.9l128%20127.9c3.6%203.6%207.8%205.4%2012.8%205.4s9.2-1.8%2012.8-5.4L287%2095c3.5-3.5%205.4-7.8%205.4-12.8%200-5-1.9-9.2-5.5-12.8z%22%2F%3E%3C%2Fsvg%3E'); background-repeat: no-repeat; background-position: right .7em top 50%; background-size: .65em auto; }
        #promptBuilderArea p.builder-default-msg { margin: 0; font-style: italic; color: #6c757d; text-align: center; }

        #areaPratica textarea#promptUsuario { width: 100%; padding: 15px; border: 1px solid #ced4da; border-radius: 6px; font-family: monospace; font-size: 1.05em; box-sizing: border-box; margin-bottom: 15px; line-height: 1.6; min-height: 150px; }
        #botoesPlayground { display: flex; gap: 12px; justify-content: flex-end; margin-bottom: 10px; }
        #botoesPlayground button { padding: 10px 20px; border: none; border-radius: 6px; cursor: pointer; font-size: 1em; font-weight: 500; transition: all 0.2s ease; }
        #botoesPlayground button i { margin-right: 8px; }
        #botaoCopiarPrompt { background-color: #28a745; color: white; }
        #botaoCopiarPrompt:hover:not([disabled]) { background-color: #218838; box-shadow: 0 2px 5px rgba(40, 167, 69, 0.3); }
        #botaoLimparPrompt { background-color: #dc3545; color: white; }
        #botaoLimparPrompt:hover { background-color: #c82333; box-shadow: 0 2px 5px rgba(220, 53, 69, 0.3); }
        #botaoCopiarPrompt:disabled { background-color: #6c757d; cursor: not-allowed; }
        #feedbackCopia { display: block; text-align: right; font-size: 0.9em; color: #28a745; font-weight: bold; height: 1.2em; transition: opacity 0.5s ease; }
        .feedback-copia-oculto { opacity: 0; }
        .feedback-copia-visivel { opacity: 1; }

        #exemploReferenciaPlayground { margin-top: 20px; }
        #exemploReferenciaPlayground strong { display: block; margin-bottom: 8px; color: #343a40; font-weight: 600; }

        /* --- Estilos Quiz --- */
        #quiz { margin-bottom: 30px; }
        #quiz-container { background-color: #ffffff; border: 1px solid #e9ecef; padding: 25px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.05); }
        #questao { font-size: 1.15em; font-weight: 600; margin-bottom: 20px; color: #343a40; line-height: 1.5; }
        #questao p code { font-weight: 500; font-size: 0.95em; }
        #questao pre { background-color: #f8f9fa; border: 1px solid #dee2e6; padding: 10px; margin-top: 10px; white-space: pre-wrap; word-wrap: break-word; border-radius: 5px; }
        #opcoes button { display: block; width: 100%; padding: 15px; margin-bottom: 12px; background-color: #f8f9fa; border: 1px solid #dee2e6; border-radius: 6px; cursor: pointer; text-align: left; transition: all 0.2s ease; color: #495057; font-size: 1em; }
        #opcoes button:hover:not([disabled]) { background-color: #e9ecef; border-color: #adb5bd; }
        #opcoes button code { font-size: 0.95em; }
        #opcoes button.correta { background-color: #d1e7dd; border-color: #a3cfbb; font-weight: 600; color: #0f5132; }
        #opcoes button.errada { background-color: #f8d7da; border-color: #f1aeb5; font-weight: 600; color: #842029;}
        #opcoes button:disabled { cursor: default; opacity: 0.8; }
        #botaoProximo { display: block; width: 100%; padding: 14px; background-color: #0056b3; color: white; border: none; border-radius: 6px; cursor: pointer; font-size: 1.15em; margin-top: 25px; transition: background-color 0.2s ease; font-weight: 500; }
        #botaoProximo:hover { background-color: #003d80; }
        #feedback { margin-top: 20px; font-weight: 600; min-height: 1.2em; font-size: 1.05em; text-align: left; padding: 12px 15px; border-radius: 5px; line-height: 1.5; }
        #feedback.feedback-correto { color: #0f5132; background-color: #d1e7dd; border: 1px solid #a3cfbb; }
        #feedback.feedback-errado { color: #842029; background-color: #f8d7da; border: 1px solid #f1aeb5; }
        #resultadoFinal { font-size: 1.25em; text-align: center; margin-top: 25px; font-weight: 600; color: #343a40; }
        #resultadoFinal p { margin-bottom: 15px; }
        #resultadoFinal button { padding: 12px 25px; margin-top: 20px; font-size: 1.05em; cursor: pointer; background-color: #5dade2; color: white; border: none; border-radius: 6px; transition: background-color 0.2s ease; font-weight: 500; }
        #resultadoFinal button:hover { background-color: #3498db; }

        /* --- Rodapé --- */
        footer { text-align: center; margin-top: 45px; padding-top: 25px; border-top: 1px solid #e9ecef; font-size: 0.9em; color: #6c757d; }
        footer p { margin-bottom: 0; }

    </style>
</head>
<body>
    <div id="container">
        <h1><i class="fas fa-magic"></i> Engenharia de Prompts para Imagens</h1>
        <img id="imagem-ilustrativa" src="NOME_DA_SUA_IMAGEM.png" alt="Ilustração sobre Geração de Imagens com IA">

        <section id="explorer">
            <h2><i class="fas fa-search"></i> Explora as Técnicas de Prompt</h2>
            <p>Clica numa técnica para aprender como aplicá-la na geração de imagens e pratica a construção do teu prompt:</p>
            <div id="botoesTecnicas">
                <button class="botao-tecnica" data-tecnica="clareza">Instruções Claras</button>
                <button class="botao-tecnica" data-tecnica="contexto">Contexto</button>
                <button class="botao-tecnica" data-tecnica="formato">Formato</button>
                <button class="botao-tecnica" data-tecnica="exemplos">Exemplos (Few-Shot)</button>
                <button class="botao-tecnica" data-tecnica="persona">Persona / Papel</button>
                <button class="botao-tecnica" data-tecnica="passos">Passo-a-Passo</button>
                <button class="botao-tecnica" data-tecnica="stepback">Step-back Prompting</button>
                <button class="botao-tecnica" data-tecnica="instrucoes_vs_restricoes">Instruções vs. Restrições</button>
                <button class="botao-tecnica" data-tecnica="iteracao">Iteração (e Documentação)</button>
            </div>
           <div id="infoTecnica"><p>Selecione uma técnica acima.</p></div>
        </section>

        <hr>

        <section id="playground">
            <h2><i class="fas fa-pencil-alt"></i> Playground de Prompts Visuais</h2>
            <div id="instrucaoPlayground"><p>Selecione uma técnica acima para obter dicas e praticar a sua escrita!</p></div>
            <div id="promptBuilderArea" style="margin-bottom: 20px; padding: 15px; background-color: #e9ecef; border-radius: 5px; border: 1px solid #dee2e6;">
                 <p class="builder-default-msg">Selecione uma técnica com ajudas (Instruções Claras, Contexto, Formato, Persona, Exemplos) para ver os seletores.</p>
            </div>
            <div id="areaPratica">
                <textarea id="promptUsuario" rows="10" placeholder="Construa o seu prompt visual com as ajudas acima (se disponíveis) ou escreva livremente aqui... Use vírgulas para separar os conceitos chave."></textarea>
                <div id="botoesPlayground">
                    <button id="botaoCopiarPrompt"><i class="fas fa-copy"></i> Copiar Prompt</button>
                    <button id="botaoLimparPrompt"><i class="fas fa-trash-alt"></i> Limpar</button>
                </div>
                <span id="feedbackCopia" class="feedback-copia-oculto">Prompt copiado para a área de transferência!</span>
            </div>
            <div id="exemploReferenciaPlayground"></div>
        </section>

        <hr>

        <section id="quiz">
             <h2><i class="fas fa-graduation-cap"></i> Testa os teus conhecimentos adquiridos</h2>
             <div id="quiz-container">
                <div id="questao">A carregar pergunta...</div>
                <div id="opcoes"></div>
                <button id="botaoProximo">Verificar / Próxima</button>
                <div id="feedback"></div>
                <div id="resultadoFinal"></div>
            </div>
        </section>

        <footer>
             <p>&copy; 2025 Ricardo Carvalho. Todos os direitos reservados.</p>
        </footer>
    </div><script>
        document.addEventListener('DOMContentLoaded', () => {

            // --- REFERÊNCIAS ---
            const botoesTecnica = document.querySelectorAll('.botao-tecnica');
            const infoTecnicaDiv = document.getElementById('infoTecnica');
            const instrucaoPlaygroundDiv = document.getElementById('instrucaoPlayground');
            const promptUsuarioTextarea = document.getElementById('promptUsuario');
            // *** Corrigido: Busca pelos botões Copiar/Limpar ANTES de adicionar listeners ***
            const botaoCopiarPrompt = document.getElementById('botaoCopiarPrompt');
            const botaoLimparPrompt = document.getElementById('botaoLimparPrompt');
            const feedbackCopiaSpan = document.getElementById('feedbackCopia');
            const exemploReferenciaPlaygroundDiv = document.getElementById('exemploReferenciaPlayground');
            const promptBuilderArea = document.getElementById('promptBuilderArea');
            const questaoDiv = document.getElementById('questao');
            const opcoesDiv = document.getElementById('opcoes');
            const feedbackDiv = document.getElementById('feedback');
            const botaoProximo = document.getElementById('botaoProximo');
            const resultadoFinalDiv = document.getElementById('resultadoFinal');
            const quizContainer = document.getElementById('quiz-container');

            // --- Função auxiliar para escapar HTML ---
            function escapeHTML(str) {
                if (!str) return "";
                const p = document.createElement('p');
                p.textContent = str;
                return p.innerHTML;
            }

             // --- DADOS DAS TÉCNICAS (Chaves Originais, Conteúdo adaptado para Imagens PT-PT) ---
            // ****** COLAR AQUI O CONTEÚDO COMPLETO DE dadosTecnicas DA RESPOSTA ANTERIOR ******
            const dadosTecnicas = {
                clareza: {
                    nome: "Instruções Claras e Específicas",
                    descricao: "Para imagens, ser claro significa descrever o <strong>assunto principal</strong> sem ambiguidades e adicionar <strong>detalhes visuais</strong> importantes (cores, formas, texturas, quantidades). Evite termos vagos como 'bonito'. Quanto mais específica for a descrição visual, melhor a IA 'vê' o que pretende.",
                    exemplo_mau: "Um carro fixe.",
                    exemplo_bom: "Um carro desportivo vermelho clássico dos anos 60, conversível, com pneus de faixa branca, estacionado numa rua de paralelo molhada pela chuva, reflexos das luzes da cidade na pintura.",
                    builderComponents: [
                        { id: "sujeito", label: "Assunto Principal:", options: ["", "gato", "cão", "pessoa", "carro desportivo", "árvore", "montanha", "edifício moderno", "objeto abstrato"] },
                        { id: "detalhe1", label: "Detalhe Visual 1:", options: ["", "vermelho", "azul", "metálico", "enferrujado", "peludo", "sorridente", "antigo", "futurista", "solitário", "gigante"] },
                        { id: "detalhe2", label: "Detalhe Visual 2:", options: ["", "com reflexos", "coberto de neve", "em chamas", "flutuante", "transparente", "minimalista", "ornamentado", "com olhos brilhantes", "com padrão às riscas"] },
                        { id: "quantidade", label: "Quantidade (se aplicável):", options: ["", "um único", "um par de", "três", "um grupo de", "uma multidão de", "vários"] }
                    ]
                },
                contexto: {
                    nome: "Fornecer Contexto",
                    descricao: "Onde e quando se passa a cena? Descreva o <strong>ambiente/cenário</strong> (interior/exterior, cidade/campo, dia/noite), a <strong>iluminação</strong> geral (solarengo, nublado, lusco-fusco) e a <strong>atmosfera</strong> (alegre, sombria, mágica). O contexto situa o assunto e define o 'mood' (ambiente/sensação) da imagem.",
                    exemplo_mau: "Um astronauta.",
                    exemplo_bom: "Um astronauta a flutuar calmamente no espaço profundo, a Terra azul e branca parcialmente visível abaixo, estrelas distantes a brilhar intensamente, sensação de solidão e admiração.",
                     builderComponents: [
                        { id: "local", label: "Localização:", options: ["", "floresta encantada", "cidade cyberpunk", "praia tropical", "pico de montanha nevado", "deserto árido", "espaço sideral", "interior de biblioteca antiga", "laboratório científico"] },
                        { id: "hora_luz", label: "Hora/Iluminação:", options: ["", "amanhecer suave", "meio-dia solarengo", "pôr do sol dourado", "noite estrelada", "luz de néon vibrante", "iluminação dramática de tempestade", "luz suave e difusa"] },
                        { id: "atmosfera", label: "Atmosfera/Sensação:", options: ["", "pacífica e serena", "épica e grandiosa", "misteriosa e inquietante", "alegre e festiva", "melancólica e nostálgica", "caótica e energética", "sonhadora e surreal"] }
                    ]
                },
                 formato: {
                    nome: "Especificar o Formato",
                    descricao: "Como deve ser o 'output' visual? Refere-se principalmente ao <strong>estilo artístico</strong> (<code>fotografia</code>, <code>pintura a óleo</code>, <code>cartoon</code>, <code>render 3D</code>), mas também pode incluir <strong>especificações técnicas</strong> como a <strong>relação de aspeto</strong> (<code>--ar 16:9</code>) ou nível de <strong>detalhe</strong> (<code>altamente detalhado</code>, <code>esboço rápido</code>).",
                    exemplo_mau: "Gato a dormir.",
                    exemplo_bom: "Gato a dormir numa almofada, fotografia macro, baixa profundidade de campo, altamente detalhado, --ar 1:1.",
                    builderComponents: [
                        { id: "meio", label: "Estilo/Meio Artístico:", options: ["", "Fotografia", "Pintura a óleo", "Aguarela", "Esboço a lápis", "Desenho a tinta", "Cartoon", "Estilo Anime", "Render 3D", "Pixel Art", "Arte Vetorial", "Escultura"] },
                        { id: "qualidade", label: "Nível de Detalhe/Qualidade:", options: ["", "Altamente detalhado", "Cinematográfico", "Realista", "Hiper-realista", "Estilizado", "Esboço rápido", "Cores vibrantes", "Monocromático", "Foco suave ('soft focus')"] },
                        { id: "aspect", label: "Relação de Aspeto (exemplo):", options: ["", "--ar 16:9 (Paisagem)", "--ar 9:16 (Retrato)", "--ar 1:1 (Quadrado)", "--ar 4:3", "--ar 3:2"] }
                    ]
                },
                exemplos: {
                    nome: "Dar Exemplos (Referências)",
                    descricao: "Embora 'few-shot' (dar vários exemplos input->output) seja mais para texto, o princípio aplica-se a imagens através de <strong>referências</strong>. Mencionar <strong>artistas</strong> (<code>estilo Van Gogh</code>), <strong>movimentos</strong> (<code>Art Nouveau</code>), <strong>obras</strong> (<code>ambiente Blade Runner</code>) ou <strong>estéticas</strong> (<code>estética Ghibli</code>) funciona como um 'exemplo' visual para a IA seguir.",
                    exemplo_mau: "Uma rapariga num campo.",
                    exemplo_bom: "Uma rapariga num campo de flores silvestres, no estilo de pintura impressionista de Monet.",
                     builderComponents: [ // Reutiliza os componentes de Persona/Referências
                        { id: "artista", label: "Referência Artística (Artista):", options: ["", "Van Gogh", "Monet", "Dali", "Picasso", "H.R. Giger", "Hayao Miyazaki", "Greg Rutkowski", "Frida Kahlo", "Tim Burton"] },
                        { id: "movimento", label: "Referência Artística (Mov./Estética):", options: ["", "Impressionismo", "Surrealismo", "Art Nouveau", "Cyberpunk", "Steampunk", "Gótico", "Minimalismo", "Bauhaus", "Pop Art", "Estética Ghibli"] },
                        { id: "obra", label: "Referência Artística (Obra/Media):", options: ["", "Blade Runner", "O Senhor dos Anéis", "Star Wars", "Bioshock", "Filme de Wes Anderson", "Akira", "Alice no País das Maravilhas"] }
                    ]
                },
                persona: {
                     nome: "Atribuir uma Persona / Papel",
                     descricao: "Embora menos direto que no texto, pode influenciar o estilo pedindo à IA para 'desenhar como' um tipo específico de artista ou referenciando um estilo muito característico. É semelhante a usar referências (ver técnica anterior).",
                     exemplo_mau: "Cidade futurista.",
                     exemplo_bom: "Desenha uma cidade futurista como se fosses Syd Mead (artista conceptual de Blade Runner).",
                     builderComponents: [ // Usa os mesmos componentes de Referências
                        { id: "artista", label: "Referência Artística (Artista):", options: ["", "Van Gogh", "Monet", "Dali", "Picasso", "H.R. Giger", "Hayao Miyazaki", "Greg Rutkowski", "Frida Kahlo", "Tim Burton"] },
                        { id: "movimento", label: "Referência Artística (Mov./Estética):", options: ["", "Impressionismo", "Surrealismo", "Art Nouveau", "Cyberpunk", "Steampunk", "Gótico", "Minimalismo", "Bauhaus", "Pop Art", "Estética Ghibli"] },
                        { id: "obra", label: "Referência Artística (Obra/Media):", options: ["", "Blade Runner", "O Senhor dos Anéis", "Star Wars", "Bioshock", "Filme de Wes Anderson", "Akira", "Alice no País das Maravilhas"] }
                    ]
                 },
                passos: {
                    nome: "Passo-a-Passo (Iteração)",
                    descricao: "Para imagens complexas, pode ser útil <strong>construir o prompt iterativamente</strong>. Comece com o essencial (assunto, estilo) e depois refine adicionando camadas de detalhe (cenário, iluminação, composição) em prompts sucessivos, analisando os resultados intermédios. É mais um processo do que uma estrutura única de prompt.",
                    exemplo_mau: "Tentar descrever uma cena hiper-complexa toda de uma vez.",
                    exemplo_bom: "1º Prompt: `gato guerreiro, armadura simples`. 2º Prompt (após ver resultado): `gato guerreiro com armadura samurai detalhada, a segurar uma katana, numa floresta de bambu ao luar`. 3º Prompt: `..., ângulo baixo, luz dramática vinda da lua`."
                },
                stepback: {
                    nome: "Step-back Prompting (Conceptualização)",
                    descricao: "Para imagens, 'dar um passo atrás' pode significar pensar primeiro nos <strong>conceitos gerais</strong> ou na <strong>emoção</strong> que quer transmitir, antes de detalhar a cena. Ex: Em vez de pedir logo 'mulher triste à chuva', pode pensar 'Quero transmitir melancolia e solidão. Como? Talvez uma figura solitária num ambiente cinzento e chuvoso.'",
                    exemplo_mau: "Prompt direto e complexo que falha em capturar a emoção.",
                    exemplo_bom: "Pensamento: Conceito = Paz na Natureza. Elementos = pessoa, lago, montanhas, manhã. Prompt: `Uma pessoa sentada sozinha na margem calma de um lago cristalino ao amanhecer, montanhas majestosas refletidas na água, névoa suave a pairar, sensação de paz profunda, estilo pintura realista.`"
                },
                instrucoes_vs_restricoes: {
                    nome: "Instruções vs. Restrições (Prompts Negativos)",
                    descricao: "Tal como no texto, é geralmente melhor focar no que <strong>quer ver</strong> (instruções positivas: <code>cores vibrantes</code>, <code>expressão feliz</code>). No entanto, em imagens, as 'restrições' são muito úteis na forma de <strong>prompts negativos</strong> para excluir o que <strong>não quer ver</strong> (<code>--no texto</code>, <code>--no mãos deformadas</code>, <code>--no desfocado</code>). Use ambos!",
                    exemplo_mau: "Um retrato (sem negativos, pode ter artefactos).",
                    exemplo_bom: "Um retrato detalhado de uma mulher idosa com olhos gentis, fundo desfocado, --no óculos, joias, maquilhagem excessiva."
                },
                iteracao: {
                    nome: "Iteração (e Documentação)",
                    descricao: "Fundamental em imagens! Analise cada resultado. O que funcionou? O que falhou? <strong>Refine</strong> o prompt: adicione/remova/altere palavras-chave, ajuste pesos (se a ferramenta permitir), experimente estilos diferentes. <strong>Documentar</strong> (mesmo que num ficheiro de texto) os prompts que deram bons resultados e porquê, é crucial para aprender e reutilizar. <p><strong>Dica Importante:</strong> A prática leva à perfeição! Não tenha medo de experimentar.</p>",
                    exemplo_mau: "Gerar uma vez, não gostar, desistir.",
                    exemplo_bom: "Gerar -> Analisar -> Ajustar prompt (ex: `+detalhe X`, `-palavra Y`, `mudar estilo para Z`) -> Gerar novamente -> Repetir até estar satisfeito."
                 }
            };

            // --- Função para atualizar a Textarea com base nos Dropdowns ---
            function atualizarPromptComBuilder() {
                 // ... (código mantido igual à versão anterior) ...
                 const selects = document.querySelectorAll('#promptBuilderArea select');
                 if (selects.length === 0) { return; }
                 let promptParts = [];
                 let selections = {};
                 selects.forEach(select => {
                    if (select.value) {
                        const key = select.id.replace('select-', '');
                        const value = select.value;
                        selections[key] = value;
                        if (key === 'aspect') return;
                        if (key === 'artista') promptParts.push(`no estilo de ${value}`);
                        else if (key === 'movimento') promptParts.push(`estética ${value}`);
                        else if (key === 'obra') promptParts.push(`ambiente tipo ${value}`);
                        else if (key === 'angulo' || key === 'plano' || key === 'luz') {
                             const match = value.match(/\((.*?)\)/);
                             promptParts.push(match ? match[1] : value);
                        }
                        else if (key !== 'sujeito' && key !== 'adjetivo1' && key !== 'adjetivo2' && key !== 'acao') {
                            promptParts.push(value);
                        }
                    }
                 });
                 const tecnicaAtiva = document.querySelector('.botao-tecnica.ativo')?.getAttribute('data-tecnica');
                 let promptInicial = "";
                 if (tecnicaAtiva === 'clareza' && selections.sujeito) {
                    promptInicial = `${selections.adjetivo1 || ''} ${selections.adjetivo2 || ''} ${selections.sujeito} ${selections.acao || ''}`.replace(/\s+/g, ' ').trim();
                    let tempParts = promptParts.filter(part => ![selections.adjetivo1, selections.adjetivo2, selections.sujeito, selections.acao].includes(part) && part !== promptInicial);
                    if (promptInicial) { promptParts = [promptInicial, ...tempParts]; }
                    else { promptParts = tempParts; }
                 }
                let promptConstruido = promptParts.filter(part => part).join(', ');
                 if (selections.aspect) { promptConstruido += (promptConstruido ? ', ' : '') + selections.aspect; }
                 promptUsuarioTextarea.value = promptConstruido;
            }


            // --- LÓGICA DO EXPLORADOR E PLAYGROUND ---
            function mostrarInfoTecnica(tecnicaId) {
                 const dados = dadosTecnicas[tecnicaId];
                 if (!dados) {
                     console.error("Dados não encontrados para a técnica:", tecnicaId);
                     infoTecnicaDiv.innerHTML = '<p>Erro: Técnica não encontrada.</p>';
                     instrucaoPlaygroundDiv.innerHTML = '<p>Erro ao carregar instruções.</p>';
                     exemploReferenciaPlaygroundDiv.innerHTML = '';
                     promptBuilderArea.innerHTML = '<p class="builder-default-msg">Erro ao carregar ajudas.</p>';
                     infoTecnicaDiv.classList.add('visivel');
                     return;
                 }
                 infoTecnicaDiv.classList.remove('visivel');
                setTimeout(() => {
                    const escapedExMau = escapeHTML(dados.exemplo_mau);
                    const escapedExBom = escapeHTML(dados.exemplo_bom);
                    const exMauHtml = dados.exemplo_mau ? `<div class="exemplo-fraco"><strong>Exemplo Fraco:</strong><pre><code>${escapedExMau}</code></pre></div>` : '';
                    const exBomHtml = dados.exemplo_bom ? `<div class="exemplo-forte"><strong>Exemplo Forte:</strong><pre><code>${escapedExBom}</code></pre></div>` : '';
                    const exBomRefHtml = dados.exemplo_bom ? `<strong>Exemplo Forte (Referência):</strong><pre><code>${escapedExBom}</code></pre>` : '';
                    infoTecnicaDiv.innerHTML = `<h3><i class="fas fa-info-circle"></i> ${dados.nome}</h3><p>${dados.descricao}</p>${exMauHtml}${exBomHtml}`;
                    exemploReferenciaPlaygroundDiv.innerHTML = exBomRefHtml;
                    let instrucaoTexto = `Pratique a técnica: <strong>${dados.nome}</strong>. Use os seletores abaixo (se disponíveis) ou escreva livremente na caixa de texto.`;
                    instrucaoPlaygroundDiv.innerHTML = `<p>${instrucaoTexto}</p>`;
                    infoTecnicaDiv.classList.add('visivel');
                    botoesTecnica.forEach(btn => btn.classList.toggle('ativo', btn.getAttribute('data-tecnica') === tecnicaId));

                    // --- Atualização do PROMPT BUILDER ---
                    promptBuilderArea.innerHTML = '';
                    let componentsParaMostrar = null;
                    // Mapeamento CORRETO das técnicas originais para os componentes definidos nos dados
                    if (dados.builderComponents) { componentsParaMostrar = dados.builderComponents; }

                    if (componentsParaMostrar) {
                        componentsParaMostrar.forEach(component => {
                            const label = document.createElement('label');
                            label.htmlFor = `select-${component.id}`;
                            label.textContent = component.label;
                            const select = document.createElement('select');
                            select.id = `select-${component.id}`;
                            select.name = component.id;
                            component.options.forEach(optionText => {
                                const option = document.createElement('option');
                                option.value = optionText;
                                option.textContent = optionText || "Selecione...";
                                select.appendChild(option);
                            });
                            select.addEventListener('change', atualizarPromptComBuilder);
                            promptBuilderArea.appendChild(label);
                            promptBuilderArea.appendChild(select);
                        });
                         atualizarPromptComBuilder();
                    } else {
                        promptBuilderArea.innerHTML = '<p class="builder-default-msg">Esta técnica não possui ajudas de construção. Use a caixa de texto abaixo.</p>';
                        promptUsuarioTextarea.focus();
                    }
                }, 50);
            }

            // Attach event listeners (Corrigido e verificado)
            botoesTecnica.forEach(botao => {
                 botao.addEventListener('click', () => {
                    mostrarInfoTecnica(botao.getAttribute('data-tecnica'));
                 });
            });


             // --- Lógica do Playground (Copiar/Limpar) - VERSÃO MELHORADA ---
             if (botaoCopiarPrompt && promptUsuarioTextarea && feedbackCopiaSpan) {
                 botaoCopiarPrompt.addEventListener('click', () => {
                     const textoParaCopiar = promptUsuarioTextarea.value;
                     if (!textoParaCopiar) { console.log("Nada para copiar."); return; }
                     if (navigator.clipboard && window.isSecureContext) {
                         navigator.clipboard.writeText(textoParaCopiar).then(() => {
                             feedbackCopiaSpan.textContent = "Prompt copiado!";
                             feedbackCopiaSpan.style.color = "#28a745";
                             feedbackCopiaSpan.classList.remove('feedback-copia-oculto');
                             feedbackCopiaSpan.classList.add('feedback-copia-visivel');
                             botaoCopiarPrompt.innerHTML = '<i class="fas fa-check"></i> Copiado!';
                             botaoCopiarPrompt.disabled = true;
                             setTimeout(() => {
                                 feedbackCopiaSpan.classList.remove('feedback-copia-visivel');
                                 feedbackCopiaSpan.classList.add('feedback-copia-oculto');
                                 botaoCopiarPrompt.innerHTML = '<i class="fas fa-copy"></i> Copiar Prompt';
                                 botaoCopiarPrompt.disabled = false;
                             }, 2000);
                         }).catch(err => {
                             console.error('Erro ao copiar com navigator.clipboard: ', err);
                             feedbackCopiaSpan.textContent = "Erro ao copiar.";
                             feedbackCopiaSpan.style.color = "#dc3545";
                             feedbackCopiaSpan.classList.remove('feedback-copia-oculto');
                             feedbackCopiaSpan.classList.add('feedback-copia-visivel');
                             setTimeout(() => {
                                 feedbackCopiaSpan.classList.remove('feedback-copia-visivel');
                                 feedbackCopiaSpan.classList.add('feedback-copia-oculto');
                                 feedbackCopiaSpan.style.color = "#28a745";
                             }, 3000);
                         });
                     } else {
                         console.warn("navigator.clipboard não disponível ou contexto não seguro.");
                         feedbackCopiaSpan.textContent = "Cópia automática falhou (contexto inseguro?). Tente copiar manualmente.";
                         feedbackCopiaSpan.style.color = "#ffc107";
                         feedbackCopiaSpan.classList.remove('feedback-copia-oculto');
                         feedbackCopiaSpan.classList.add('feedback-copia-visivel');
                           setTimeout(() => {
                             feedbackCopiaSpan.classList.remove('feedback-copia-visivel');
                             feedbackCopiaSpan.classList.add('feedback-copia-oculto');
                             feedbackCopiaSpan.style.color = "#28a745";
                         }, 4000);
                         promptUsuarioTextarea.select();
                         promptUsuarioTextarea.setSelectionRange(0, 99999);
                     }
                 });
             } else { console.error("Botão Copiar ou elementos associados não encontrados!"); }

             if (botaoLimparPrompt && promptUsuarioTextarea) {
                 botaoLimparPrompt.addEventListener('click', () => {
                     try {
                         promptUsuarioTextarea.value = '';
                         const tecnicaAtivaElement = document.querySelector('.botao-tecnica.ativo');
                         if (tecnicaAtivaElement) {
                            const tecnicaAtiva = tecnicaAtivaElement.getAttribute('data-tecnica');
                            if (tecnicaAtiva && dadosTecnicas[tecnicaAtiva] && dadosTecnicas[tecnicaAtiva].builderComponents) {
                                 document.querySelectorAll('#promptBuilderArea select').forEach(select => select.value = "");
                                 atualizarPromptComBuilder();
                            }
                         }
                         promptUsuarioTextarea.focus();
                     } catch (error) {
                         console.error("Erro ao limpar ou resetar dropdowns:", error);
                         promptUsuarioTextarea.value = '';
                         promptUsuarioTextarea.focus();
                     }
                 });
            } else { console.error("Botão Limpar ou textarea não encontrados!"); }
            // --- Fim da Lógica do Playground ---


            // --- LÓGICA DO QUIZ ---
             // ****** COLAR AQUI O ARRAY perguntasQuiz COMPLETO DA RESPOSTA ANTERIOR ******
             // (Incluindo as perguntas de 1 a 24 já corrigidas)
            const perguntasQuiz = [
                 // Clareza (3)
                 { tipo: 'escolha_melhor', pergunta: "Para obter uma imagem clara de um 'pássaro azul numa árvore', qual prompt demonstra melhor a técnica de Instruções Claras?", opcoes: [ { texto: "pássaro", isPrompt: true }, { texto: "pássaro azul numa árvore", isPrompt: true }, { texto: "Um pequeno pássaro azul vibrante (tipo Blue Jay) pousado num ramo de carvalho com folhas verdes, fundo ligeiramente desfocado, luz da manhã", isPrompt: true }, { texto: "animal numa árvore", isPrompt: true } ], respostaCorreta: 2, explicacao: "A clareza vem da especificação do tipo de pássaro, cor, ação, árvore, fundo e luz." },
                { tipo: 'identifica_tecnica', pergunta: "Ao adicionar 'com pelo macio e branco, olhos azuis penetrantes' a um prompt de 'gato', qual técnica está a aplicar principalmente?", prompt_na_pergunta: null, opcoes: [ { texto: "Contexto" }, { texto: "Formato" }, { texto: "Instruções Claras (Detalhe)" }, { texto: "Persona" } ], respostaCorreta: 2, explicacao: "Está a adicionar detalhes específicos para clarificar a aparência do assunto." },
                { tipo: 'spot_the_flaw', pergunta: "Instrução: Desenha um carro. Porque é que esta instrução viola o princípio da Clareza?", prompt_na_pergunta: null, opcoes: [ { texto: "Não especifica a cor" }, { texto: "Não especifica o estilo (cartoon, foto)" }, { texto: "Falta tipo de carro, marca, ano, estado (novo/velho)" }, { texto: "Todas as anteriores contribuem para a falta de detalhe e clareza." } ], respostaCorreta: 3, explicacao: "A falta de detalhes sobre o tipo de carro, cor, estilo, etc., deixa muitas opções em aberto para a IA." },
                // Contexto (3)
                { tipo: 'escolha_melhor', pergunta: "Quer um 'guerreiro solitário'. Qual prompt estabelece melhor o Contexto para uma imagem atmosférica?", opcoes: [ { texto: "guerreiro solitário", isPrompt: true }, { texto: "guerreiro com espada", isPrompt: true }, { texto: "Guerreiro solitário em armadura desgastada, de pé no topo de uma colina ventosa ao pôr do sol, céu carregado de nuvens, atmosfera melancólica", isPrompt: true }, { texto: "homem sozinho", isPrompt: true } ], respostaCorreta: 2, explicacao: "O contexto (colina, pôr do sol, céu, atmosfera) é crucial para a imagem." },
                { tipo: 'identifica_tecnica', pergunta: "Incluir 'numa rua chuvosa de Tóquio à noite, com reflexos néon' num prompt de 'pessoa com guarda-chuva' aplica qual técnica?", prompt_na_pergunta: null, opcoes: [ { texto: "Instruções Claras" }, { texto: "Contexto" }, { texto: "Exemplos (Few-Shot)" }, { texto: "Iteração" } ], respostaCorreta: 1, explicacao: "Define o cenário, a hora, o tempo e o local, fornecendo contexto." },
                { tipo: 'spot_the_flaw', pergunta: "Instrução: Robot a andar. A IA gera o robot num fundo branco. Se o objetivo era uma cena urbana, qual técnica falhou?", prompt_na_pergunta: null, opcoes: [ { texto: "Clareza (detalhes do robot)" }, { texto: "Formato (estilo)" }, { texto: "Contexto (faltou definir o cenário)" }, { texto: "Persona" } ], respostaCorreta: 2, explicacao: "O contexto (o cenário urbano) não foi fornecido." },
                 // Formato (3)
                 { tipo: 'escolha_melhor', pergunta: "Para pedir uma imagem que pareça um desenho técnico, qual especificação de Formato é mais adequada?", opcoes: [ { texto: "desenho", isPrompt: true }, { texto: "imagem técnica", isPrompt: true }, { texto: "esboço de arquitetura", isPrompt: true }, { texto: "desenho blueprint, linhas finas azuis sobre fundo branco, vista isométrica", isPrompt: true } ], respostaCorreta: 3, explicacao: "Especifica o formato exato ('blueprint'), cores, linhas e vista, definindo o output visual." },
                 { tipo: 'identifica_tecnica', pergunta: "Ao especificar '--ar 16:9' ou 'aspect ratio 16:9' num prompt, está a usar a técnica de:", prompt_na_pergunta: null, opcoes: [ { texto: "Persona" }, { texto: "Formato (Especificação Técnica)" }, { texto: "Contexto" }, { texto: "Step-back Prompting" } ], respostaCorreta: 1, explicacao: "Define um aspeto técnico do formato da imagem final." },
                 { tipo: 'spot_the_flaw', pergunta: "Instrução: Retrato de homem. A IA gera uma fotografia. Se queria uma pintura a óleo, qual técnica de Formato faltou especificar?", prompt_na_pergunta: null, opcoes: [ { texto: "Relação de Aspeto" }, { texto: "Estilo / Meio Artístico (ex: 'pintura a óleo')" }, { texto: "Nível de detalhe" }, { texto: "Ângulo da câmara" } ], respostaCorreta: 1, explicacao: "Faltou especificar o meio artístico desejado como parte do formato." },
                 // Exemplos (Few-Shot) / Referências (3)
                { tipo: 'escolha_melhor', pergunta: "Quer uma ilustração infantil fofa. Como pode usar a técnica de Exemplos (Referências)?", opcoes: [ { texto: "ilustração fofa", isPrompt: true }, { texto: "desenho para crianças", isPrompt: true }, { texto: "coelho sorridente a segurar uma cenoura, no estilo de ilustração de Beatrix Potter", isPrompt: true }, { texto: "coelho feliz", isPrompt: true } ], respostaCorreta: 2, explicacao: "Referenciar um ilustrador conhecido (Beatrix Potter) serve como um exemplo visual do estilo pretendido." },
                { tipo: 'identifica_tecnica', pergunta: "Pedir uma imagem no estilo de pintura de Salvador Dali aplica qual técnica?", prompt_na_pergunta: null, opcoes: [ { texto: "Instruções Claras" }, { texto: "Contexto" }, { texto: "Exemplos (Referências)" }, { texto: "Formato" } ], respostaCorreta: 2, explicacao: "Usa um artista como exemplo/referência para definir o estilo surrealista." },
                { tipo: 'conceito', pergunta: "Por que usar referências (artistas, estilos, obras) é eficaz na geração de imagens?", prompt_na_pergunta: false, opcoes: [ { texto: "Porque limita a criatividade da IA." }, { texto: "Porque a IA reconhece esses nomes e tenta imitar as características visuais associadas, funcionando como um 'exemplo'." }, { texto: "Porque garante sempre uma cópia exata." }, { texto: "Porque melhora a resolução da imagem." } ], respostaCorreta: 1, explicacao: "As referências funcionam como 'exemplos' visuais que a IA pode usar para guiar o estilo e o 'mood'." },
                 // Persona / Papel (2)
                 { tipo: 'escolha_melhor', pergunta: "Como poderia usar a técnica de Persona para gerar um design de personagem de fantasia original?", opcoes: [ { texto: "personagem de fantasia", isPrompt: true }, { texto: "desenha um elfo", isPrompt: true }, { texto: "Age como um artista conceptual de jogos de fantasia e cria um design único para um 'Druida do Deserto', detalhando o seu traje e acessórios", isPrompt: true }, { texto: "elfo com arco", isPrompt: true } ], respostaCorreta: 2, explicacao: "Define o 'papel' da IA (artista conceptual) e dá uma tarefa específica dentro desse papel." },
                 { tipo: 'identifica_tecnica', pergunta: "A instrução 'cria uma imagem como se fosses um fotógrafo de naturea a capturar um momento raro' está a usar principalmente a técnica de:", prompt_na_pergunta: false, opcoes: [ { texto: "Formato" }, { texto: "Persona / Papel" }, { texto: "Contexto" }, { texto: "Exemplos" } ], respostaCorreta: 1, explicacao: "Atribui um papel específico (fotógrafo de natureza) à IA para influenciar a perspetiva e possivelmente o estilo." },
                 // Passo-a-Passo (Iteração) (2)
                 { tipo: 'conceito', pergunta: "Gerou uma imagem base de 'floresta'. Qual seria um bom segundo passo (Iteração / Passo-a-Passo) para adicionar um elemento mágico?", opcoes: [ { texto: "Tentar 'floresta mágica' do zero." }, { texto: "Adicionar ao prompt inicial: ', com cogumelos gigantes brilhantes e um unicórnio escondido entre as árvores'." }, { texto: "Pedir a mesma imagem em estilo diferente." }, { texto: "Aumentar o contraste da imagem." } ], respostaCorreta: 1, explicacao: "A iteração envolve refinar o prompt adicionando os novos elementos desejados à descrição existente, como num processo passo-a-passo." },
                 { tipo: 'identifica_tecnica', pergunta: "Começar com `céu azul` e depois gerar `céu azul com nuvens brancas fofas` e depois `céu azul com nuvens e um avião a jato a passar` demonstra qual processo?", prompt_na_pergunta: false, opcoes: [ { texto: "Few-Shot Learning" }, { texto: "Step-back Prompting" }, { texto: "Passo-a-Passo (Iteração)" }, { texto: "Persona" } ], respostaCorreta: 2, explicacao: "Mostra a construção gradual e o refinamento da imagem através de prompts sucessivos, como um processo passo-a-passo." },
                 // Step-back Prompting (Conceptualização) (2)
                 { tipo: 'conceito', pergunta: "Antes de pedir 'um robô triste na chuva', pensar 'Quero evocar solidão e tecnologia obsoleta' é um exemplo de qual abordagem?", opcoes: [ { texto: "Definir Formato" }, { texto: "Step-back Prompting (Conceptualização)" }, { texto: "Prompt Negativo" }, { texto: "Iteração" } ], respostaCorreta: 1, explicacao: "É pensar no conceito ou emoção geral ('dar um passo atrás') antes de detalhar a cena específica." },
                 { tipo: 'escolha_melhor', pergunta: "Quer uma imagem que represente 'caos urbano'. Qual prompt aplica melhor a ideia de conceptualizar primeiro (Step-back)?", opcoes: [ { texto: "cidade caótica", isPrompt: true }, { texto: "carros e pessoas na rua", isPrompt: true }, { texto: "Representação visual do caos urbano: trânsito intenso, multidões apressadas, edifícios sobrepostos, poluição visual, estilo 'gritty' (realista e sujo)", isPrompt: true }, { texto: "rua movimentada", isPrompt: true } ], respostaCorreta: 2, explicacao: "Começa pelo conceito ('Representação visual do caos urbano') e depois detalha elementos que o evocam." },
                 // Instruções vs Restrições (Prompts Negativos) (2)
                 { tipo: 'escolha_melhor', pergunta: "Quer uma fotografia de retrato limpa, sem elementos a distrair. Qual instrução é mais eficaz usando Instruções Positivas e Restrições (Negativas)?", opcoes: [ { texto: "retrato de mulher", isPrompt: true }, { texto: "Não quero fundo confuso", isPrompt: false }, { texto: "Retrato de mulher sorridente, fundo simples e desfocado (bokeh), boa iluminação --no outras pessoas, objetos, texto", isPrompt: true }, { texto: "Foca na mulher", isPrompt: false } ], respostaCorreta: 2, explicacao: "Combina instruções positivas (fundo desfocado, boa iluminação) com negativas (--no) para obter o resultado." },
                 { tipo: 'identifica_tecnica', pergunta: "Adicionar '--no deformed fingers, extra limbs' a um prompt de 'pessoa' é um exemplo de:", prompt_na_pergunta: false, opcoes: [ { texto: "Contexto" }, { texto: "Instruções vs. Restrições (Prompt Negativo)" }, { texto: "Formato" }, { texto: "Persona" } ], respostaCorreta: 1, explicacao: "Usa restrições (negativas) para evitar problemas comuns na geração de anatomia." },
                 // Iteração e Documentação (2)
                 { tipo: 'conceito', pergunta: "Qual a importância de documentar os prompts que geraram imagens interessantes?", opcoes: [ { texto: "Não tem importância, a IA é aleatória." }, { texto: "Apenas para cumprir regras." }, { texto: "Para aprender que combinações de palavras-chave, estilos e parâmetros funcionam bem e poder reutilizá-los ou adaptá-los.", isPrompt: false }, { texto: "Para treinar a IA com esses prompts." } ], respostaCorreta: 2, explicacao: "Documentar ajuda a aprender, reutilizar e otimizar o processo de criação de imagens." },
                 { tipo: 'conceito', pergunta: "O que significa 'Iterar' no contexto de prompt engineering para imagens?", prompt_na_pergunta: false, opcoes: [ { texto: "Gerar a mesma imagem muitas vezes" }, { texto: "Usar sempre os mesmos prompts" }, { texto: "Ajustar e refinar o prompt com base nos resultados anteriores" }, { texto: "Pedir ajuda a outra pessoa" } ], respostaCorreta: 2, explicacao: "Iterar é o processo de tentativa, análise e refinamento do prompt, fundamental nesta técnica." }
            ];


            let perguntaAtualIndex = 0;
            let pontuacao = 0;
            let respostaSelecionada = false;

            // --- Funções do Quiz ---
            function carregarPergunta() {
                respostaSelecionada = false;
                feedbackDiv.textContent = '';
                feedbackDiv.className = 'feedback';
                botaoProximo.textContent = "Verificar";
                botaoProximo.disabled = true;
                const totalPerguntas = perguntasQuiz.length;
                document.querySelector('#quiz h2').innerHTML = `<i class="fas fa-graduation-cap"></i> Testa os teus conhecimentos adquiridos (${perguntaAtualIndex + 1}/${totalPerguntas})`;

                if (perguntaAtualIndex < totalPerguntas) {
                    const perguntaAtual = perguntasQuiz[perguntaAtualIndex];
                    let questaoHTML = `<p>${perguntaAtualIndex + 1}. ${escapeHTML(perguntaAtual.pergunta)}`;
                    if (perguntaAtual.prompt_na_pergunta) {
                         if (!perguntaAtual.pergunta.endsWith(' ')) questaoHTML += ' ';
                        questaoHTML += `<pre><code>${escapeHTML(perguntaAtual.prompt_na_pergunta)}</code></pre>`;
                    }
                     questaoHTML += `</p>`;
                    questaoDiv.innerHTML = questaoHTML;

                    opcoesDiv.innerHTML = '';
                    perguntaAtual.opcoes.forEach((opcao, index) => {
                        const botao = document.createElement('button');
                        const textoEscapado = escapeHTML(opcao.texto);
                        if (opcao.isPrompt) {
                             botao.innerHTML = `<code>${textoEscapado}</code>`;
                        } else {
                             botao.innerHTML = textoEscapado;
                        }
                        botao.onclick = () => {
                            if (respostaSelecionada) return;
                            const todosBotoesOpcao = opcoesDiv.querySelectorAll('button');
                            todosBotoesOpcao.forEach(b => b.style.fontWeight = 'normal');
                            botao.style.fontWeight = 'bold';
                            botaoProximo.disabled = false;
                            botaoProximo.dataset.opcaoEscolhidaIndex = index;
                          };
                        opcoesDiv.appendChild(botao);
                    });
                    botaoProximo.onclick = verificarResposta;
                } else {
                    mostrarResultado();
                }
            }

            function verificarResposta() {
                 if (respostaSelecionada) return;
                 respostaSelecionada = true;
                 const perguntaAtual = perguntasQuiz[perguntaAtualIndex];
                 if (!perguntaAtual) return;
                 const indiceEscolhido = parseInt(botaoProximo.dataset.opcaoEscolhidaIndex);
                 const indiceCorreto = perguntaAtual.respostaCorreta;
                 const todosBotoesOpcao = opcoesDiv.querySelectorAll('button');
                 const botaoClicado = todosBotoesOpcao[indiceEscolhido];
                 todosBotoesOpcao.forEach(b => b.disabled = true);
                 const explicacaoHtml = perguntaAtual.explicacao ? `<em>(${escapeHTML(perguntaAtual.explicacao)})</em>` : '';
                 if (indiceEscolhido === indiceCorreto) {
                     pontuacao++;
                     botaoClicado.classList.add('correta');
                     feedbackDiv.innerHTML = `Correto! 👍 ${explicacaoHtml}`;
                     feedbackDiv.className = 'feedback feedback-correto';
                 } else {
                     botaoClicado.classList.add('errada');
                     feedbackDiv.innerHTML = `Errado. 😕 <br>${explicacaoHtml || '<em>Tente pensar qual técnica se aplicaria melhor.</em>'}`;
                     feedbackDiv.className = 'feedback feedback-errado';
                     if (todosBotoesOpcao[indiceCorreto]) {
                          todosBotoesOpcao[indiceCorreto].classList.add('correta');
                          todosBotoesOpcao[indiceCorreto].style.fontWeight = 'bold';
                     }
                 }
                 botaoProximo.textContent = "Próxima Pergunta";
                 botaoProximo.disabled = false;
                 botaoProximo.onclick = proximaPergunta;
            }

            function proximaPergunta() {
                 perguntaAtualIndex++;
                 carregarPergunta();
            }

            function mostrarResultado() {
                 const totalPerguntasReal = perguntasQuiz.length;
                 document.querySelector('#quiz h2').innerHTML = `<i class="fas fa-check-circle"></i> Quiz Terminado!`;
                 quizContainer.innerHTML = '';
                 let mensagemFinal = "";
                 const percentagem = totalPerguntasReal > 0 ? (pontuacao / totalPerguntasReal) * 100 : 0;
                 if (percentagem >= 80) { mensagemFinal = "Excelente! Parece que tens olho para criar prompts visuais eficazes!"; }
                 else if (percentagem >= 50) { mensagemFinal = "Bom resultado! A prática leva à perfeição na arte visual."; }
                 else { mensagemFinal = "Continua a experimentar! A chave é combinar técnicas e refinar."; }
                 resultadoFinalDiv.innerHTML = `<h2><i class="fas fa-check-circle"></i> Quiz Terminado!</h2><p>A tua pontuação final foi: <strong>${pontuacao}</strong> em ${totalPerguntasReal} (${percentagem.toFixed(0)}%).</p><p><em>${escapeHTML(mensagemFinal)}</em></p><button onclick="window.location.reload()"><i class="fas fa-redo"></i> Tentar Novamente</button>`;
                 quizContainer.appendChild(resultadoFinalDiv);
            }

            // --- Inicialização ---
             if (typeof dadosTecnicas !== 'undefined' && typeof perguntasQuiz !== 'undefined') {
                 carregarPergunta(); // Inicia o Quiz
             } else {
                 quizContainer.innerHTML = '<p style="color: red; text-align: center;">Erro crítico ao carregar os dados da aplicação. Por favor, verifique o código.</p>';
                 console.error("Erro Fatal: dadosTecnicas ou perguntasQuiz não estão definidos corretamente no script.");
             }

        }); // Fim do DOMContentLoaded
    </script>
</body>
</html>
